---
import { Image } from "astro:assets"
import type { CollectionEntry } from "astro:content"

interface Props {
  project: CollectionEntry<"work">
}

const { project } = Astro.props
const { data, id } = project
---

<a href={`/work/${id}`} class="w-full" data-astro-prefetch transition:persist>
  {
    data.card.type === "video" ? (
      <video
        src={data.card.src}
        class="mx-auto h-auto max-h-[50vh] w-auto animate-fadeIn rounded-lg opacity-100 transition-opacity duration-300 hover:opacity-70"
        autoplay
        muted
        loop
        playsinline
        preload="metadata"
        transition:name={id}
      />
    ) : (
      <Image
        src={data.card.src}
        alt={data.card.alt || ""}
        class="max-h-[50vh] animate-fadeIn rounded-lg opacity-100 transition-opacity duration-300 hover:opacity-70"
        transition:name={id}
      />
    )
  }
  <div class="mt-2 flex items-start justify-between gap-4">
    <div class="flex min-w-0 flex-1 flex-col text-sm leading-5 transition-transform duration-500 hover:scale-105">
      <span class="whitespace-normal break-words font-medium">{data.title}</span>
      <span class="whitespace-normal break-words capitalize tracking-wide text-neutral-500">
        {data.caption}
      </span>
    </div>

    <ul class="hidden flex-shrink-0 flex-wrap justify-end gap-1 md:flex">
      {
        data.tags
          .slice(0, 3)
          .map((tag) => (
            <li class="rounded-full border border-primary bg-primary/60 px-2 py-1 text-center text-xs font-semibold text-foreground transition-transform duration-300 ease-in-out hover:-translate-y-0.5">
              {tag}
            </li>
          ))
      }
    </ul>
  </div>
</a>
