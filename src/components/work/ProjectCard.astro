---
import { Image } from "astro:assets"
import type { CollectionEntry } from "astro:content"

interface Props {
  project: CollectionEntry<"work">
  delay: number
}

const { project, delay } = Astro.props
const { data, id } = project
---

<a
  href={`/work/${id}`}
  class="w-full animate-fadeIn opacity-0"
  style={`animation-delay: ${delay}ms; animation-fill-mode: forwards;`}
  data-astro-prefetch
>
  {
    data.card.type === "video" ? (
      <video
        src={data.card.src}
        class="mx-auto h-auto max-h-[50vh] w-auto rounded-lg opacity-100 transition-opacity duration-300 hover:opacity-70"
        autoplay
        muted
        loop
        playsinline
        preload="metadata"
        transition:name={id}
        transition:animate="initial"
      />
    ) : (
      <Image
        src={data.card.src}
        alt={data.card.alt || ""}
        class="max-h-[50vh] rounded-lg opacity-100 transition-opacity duration-300 hover:opacity-70"
        transition:name={id}
        transition:animate="initial"
      />
    )
  }
  <div class="mt-2 flex justify-between gap-4">
    <div class="flex h-full flex-shrink-0 flex-col text-sm leading-5 transition-transform duration-500 hover:scale-105">
      <span class="capital font-medium">{data.title}</span>
      <span class="capitalize tracking-wide text-neutral-500">
        {data.caption}
      </span>
    </div>

    <ul class="flex-shrink">
      {
        data.tags
          .slice(0, 3)
          .map((tag) => (
            <li class="mx-0.5 mb-1 hidden rounded-full border border-primary bg-primary/60 px-2 py-1 text-center text-xs font-semibold text-foreground transition-transform duration-300 ease-in-out hover:-translate-y-0.5 md:inline-block">
              {tag}
            </li>
          ))
      }
    </ul>
  </div>
</a>
